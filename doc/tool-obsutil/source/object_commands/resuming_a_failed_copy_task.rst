:original_name: obs_11_0037.html

.. _obs_11_0037:

Resuming a Failed Copy Task
===========================

Function
--------

You can use this command to resume a failed copy task based on the task ID.

Command Line Structure
----------------------

-  In Windows

   .. code-block::

      obsutil cp -recover=xxx [-dryRun] [-f] [-u] [-crr] [-vlength] [-vmd5] [-j=1] [-p=1] [-threshold=52428800] [-acl=xxx] [-sc=xxx] [-meta=aaa:bbb#ccc:ddd] [-ps=auto] [-include=*.xxx] [-exclude=*.xxx] [-timeRange=time1-time2] [-mf] [-o=xxx] [-cpd=xxx] [-clear] [-config=xxx]

-  In Linux or macOS

   .. code-block::

      ./obsutil cp -recover=xxx [-dryRun] [-f] [-u] [-crr] [-vlength] [-vmd5] [-j=1] [-p=1] [-threshold=52428800] [-acl=xxx] [-sc=xxx] [-meta=aaa:bbb#ccc:ddd] [-ps=auto] [-include=*.xxx] [-exclude=*.xxx] [-timeRange=time1-time2] [-mf] [-o=xxx] [-cpd=xxx] [-clear] [-config=xxx]

Examples
--------

-  Take the Windows OS as an example. Run the **obsutil cp -recover=0476929d-9d23-4dc5-b2f8-0a0493f027c5 -f** command to copy objects in batches.

   .. code-block::

      obsutil cp -recover=0476929d-9d23-4dc5-b2f8-0a0493f027c5 -f

   .. code-block::

      Start at 2024-10-08 01:10:07.3809685 +0000 UTC

      Parallel:      5                   Jobs:          5
      Threshold:     50.00MB             PartSize:      auto
      VerifyLength:  false               VerifyMd5:     false
      CheckpointDir: xxxx

      Task id: a628d6da-c562-4a1f-b687-4fa125de0dc3
      OutputDir: xxxx
      TempFileDir: xxxx

      [========================================================] 100.00% tps:35.71 2.02 KB/s 7.20MB/7.20MB 0s
      Succeed count:      1         Failed count:       0
      Succeed bytes:      xxx
      Metrics [max cost:90 ms, min cost:45 ms, average cost:63.80 ms, average tps:35.71, transferred size:70B]

      Task id: a628d6da-c562-4a1f-b687-4fa125de0dc3

Parameter Description
---------------------

+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Parameter             | Optional or Mandatory            | Description                                                                                                                                                                                                                                                                                                          |
+=======================+==================================+======================================================================================================================================================================================================================================================================================================================+
| recover               | Mandatory (additional parameter) | The ID of the copy task to be resumed                                                                                                                                                                                                                                                                                |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  You can obtain the task ID after a copy task is complete, or query it based on the file name of the :ref:`result list <obs_11_0057>`. A task ID is the 36 characters, excluding the suffix **.txt**.                                                                                                           |
|                       |                                  |    -  You can locate the copy task to be resumed in the folder where the result files reside. For details about the path of the result folder, see additional parameter **o**.                                                                                                                                       |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| dryRun                | Optional (additional parameter)  | Conducts a dry run.                                                                                                                                                                                                                                                                                                  |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| crr                   | Optional (additional parameter)  | Enables the client-side cross-region replication function. In this mode, data is directly copied to the destination bucket from the source bucket through data stream. The buckets can be any two OBS buckets.                                                                                                       |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  If this parameter is configured, ensure that the configuration of client-side cross-region replication is updated in the configuration file. For details, see :ref:`Updating a Configuration File <obs_11_0023>`.                                                                                              |
|                       |                                  |    -  The configurations of the source bucket and destination bucket are respectively **akCrr/skCrr/tokenCrr/endpointCrr** and **ak/sk/token/endpoint** in the configuration file.                                                                                                                                   |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. important::                                                                                                                                                                                                                                                                                                       |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    NOTICE:                                                                                                                                                                                                                                                                                                           |
|                       |                                  |    When cross-region replication is enabled, the upload/download bandwidth, CPU, and memory resources of the host where commands are executed will be occupied, which may deteriorate the host performance.                                                                                                          |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| vlength               | Optional (additional parameter)  | Verifies whether the object size in the destination bucket is the same as that in the source bucket after the copy task completes.                                                                                                                                                                                   |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    This parameter must be used together with **crr**.                                                                                                                                                                                                                                                                |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| vmd5                  | Optional (additional parameter)  | Verifies whether the MD5 value of the destination bucket is the same as that of the source bucket after the copy task completes.                                                                                                                                                                                     |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  This parameter must be used together with **crr**.                                                                                                                                                                                                                                                             |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  Objects in the source bucket must contain metadata **x-obs-meta-md5chksum**, or MD5 verification will be skipped.                                                                                                                                                                                              |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |       After the MD5 verification is successful, this parameter value is used for metadata **x-obs-meta-md5chksum** of the destination object, for later MD5 verification during download or copy.                                                                                                                    |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. caution::                                                                                                                                                                                                                                                                                                         |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    CAUTION:                                                                                                                                                                                                                                                                                                          |
|                       |                                  |    If your object needs encryption, do not use this parameter.                                                                                                                                                                                                                                                       |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| u                     | Optional (additional parameter)  | Indicates incremental copy. If this parameter is set, each object can be copied only when it does not exist in the destination bucket, its size is different from the namesake one in the destination bucket, or it has the latest modification time.                                                                |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| p                     | Optional (additional parameter)  | The maximum number of concurrent multipart copy tasks when copying an object. The default value is the value of **defaultParallels** in the configuration file.                                                                                                                                                      |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| threshold             | Optional (additional parameter)  | The threshold for enabling multipart copy, in bytes. The default value is the value of **defaultBigfileThreshold** in the configuration file.                                                                                                                                                                        |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  If the size of the object to be copied is smaller than the threshold, copy the object directly. If not, a multipart copy is required.                                                                                                                                                                          |
|                       |                                  |    -  If you copy an object directly, no part record is generated, and resumable transmission is not supported.                                                                                                                                                                                                      |
|                       |                                  |    -  This parameter value can contain a unit, for example, **1MB** (indicating 1,048,576 bytes).                                                                                                                                                                                                                    |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| acl                   | Optional (additional parameter)  | The access control policies for destination objects that can be specified when copying objects. Possible values are:                                                                                                                                                                                                 |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | -  private                                                                                                                                                                                                                                                                                                           |
|                       |                                  | -  public-read                                                                                                                                                                                                                                                                                                       |
|                       |                                  | -  public-read-write                                                                                                                                                                                                                                                                                                 |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    The preceding three values indicate private read and write, public read, and public read and write.                                                                                                                                                                                                               |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| sc                    | Optional (additional parameter)  | The storage classes of the destination objects that can be specified when copying objects. Possible values are:                                                                                                                                                                                                      |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | -  **standard**: Standard storage class. It features low access latency and high throughput, and is applicable to storing frequently accessed data (multiple accesses per month) or data that is smaller than 1 MB.                                                                                                  |
|                       |                                  | -  **warm**: Warm storage class. It is ideal for storing infrequently accessed (less than 12 times a year) data, but when needed, the access has to be fast.                                                                                                                                                         |
|                       |                                  | -  **cold**: Cold storage class. It provides secure, durable, and inexpensive storage for rarely-accessed (once a year) data.                                                                                                                                                                                        |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| meta                  | Optional (additional parameter)  | The metadata of destination objects that can be specified when copying objects. This parameter should be configured in the following format: *key1*\ **:**\ *value1*\ **#**\ *key2*\ **:**\ *value2*\ **#**\ *key3*\ **:**\ *value3*.                                                                                |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    The format example above indicates that the destination objects contain three groups of custom metadata: *key1:value1*, *key2:value2*, and *key3:value3*.                                                                                                                                                         |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ps                    | Optional (additional parameter)  | The size of each part in a multipart copy task, in bytes. The value ranges from **100KB** to **5GB**. The default value is the value of **defaultPartSize** in the configuration file.                                                                                                                               |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  This parameter value can contain a unit, for example, **1MB** (indicating 1,048,576 bytes).                                                                                                                                                                                                                    |
|                       |                                  |    -  The parameter can be set to **auto**. In this case, obsutil automatically sets the part size for each multipart task based on the source object size.                                                                                                                                                          |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| cpd                   | Optional (additional parameter)  | The folder where the part records reside. The default value is **.obsutil_checkpoint**, the subfolder in the home directory of the user who executes obsutil commands.                                                                                                                                               |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    A part record is generated during a multipart copy and saved to the **copy** subfolder. After the copy succeeds, its part record is deleted automatically. If the copy fails or is suspended, the system attempts to resume the task according to its part record when you perform the copy the next time.        |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| f                     | Optional (additional parameter)  | Runs in force mode.                                                                                                                                                                                                                                                                                                  |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| j                     | Optional (additional parameter)  | The maximum number of concurrent tasks for copying objects in batches. The default value is the value of **defaultJobs** in the configuration file.                                                                                                                                                                  |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    The value is ensured to be greater than or equal to 1.                                                                                                                                                                                                                                                            |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| exclude               | Optional (additional parameter)  | The matching patterns of source objects that are excluded, for example: **\*.txt**                                                                                                                                                                                                                                   |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  The asterisk (*) represents any group of characters, and the question mark (?) represents any single character. For instance, **abc*.txt** indicates any file whose name starts with **abc** and ends with **.txt**.                                                                                           |
|                       |                                  |    -  You can use **\\\*** to represent **\*** and **\\?** to represent **?**.                                                                                                                                                                                                                                       |
|                       |                                  |    -  If the name of the object to be copied matches the value of this parameter, the object is skipped.                                                                                                                                                                                                             |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. important::                                                                                                                                                                                                                                                                                                       |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    NOTICE:                                                                                                                                                                                                                                                                                                           |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  You are advised to use quotation marks for the matching pattern to prevent special characters from being escaped by the OS and leading to unexpected results. Use single quotation marks for Linux or macOS and double quotation marks for Windows.                                                            |
|                       |                                  |    -  The matching pattern applies to the absolute path of an object, including the object name prefix and object name starting from the root directory. For example, if the path of an object in the bucket is **obs://bucket/src1/src2/test.txt**, then the absolute path of the object is **src1/src2/test.txt**. |
|                       |                                  |    -  This matching pattern applies only to objects whose names do not end with a slash (/).                                                                                                                                                                                                                         |
|                       |                                  |    -  Multiple **exclude** parameters can be specified, for example, **-exclude=*.xxx -exclude=*.xxx**.                                                                                                                                                                                                              |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| include               | Optional (additional parameter)  | The matching patterns of source objects that are included, for example: **\*.jpg**                                                                                                                                                                                                                                   |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  The asterisk (*) represents any group of characters, and the question mark (?) represents any single character.                                                                                                                                                                                                |
|                       |                                  |    -  You can use **\\\*** to represent **\*** and **\\?** to represent **?**.                                                                                                                                                                                                                                       |
|                       |                                  |    -  Only after identifying that the name of the file to be copied does not match the value of **exclude**, the system checks whether the file name matches the value of this parameter. If yes, the file is copied. If not, the file is skipped.                                                                   |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. important::                                                                                                                                                                                                                                                                                                       |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    NOTICE:                                                                                                                                                                                                                                                                                                           |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  You are advised to use quotation marks for the matching pattern to prevent special characters from being escaped by the OS and leading to unexpected results. Use single quotation marks for Linux or macOS and double quotation marks for Windows.                                                            |
|                       |                                  |    -  The matching pattern applies to the absolute path of an object, including the object name prefix and object name starting from the root directory. For example, if the path of an object in the bucket is **obs://bucket/src1/src2/test.txt**, then the absolute path of the object is **src1/src2/test.txt**. |
|                       |                                  |    -  This matching pattern applies only to objects whose names do not end with a slash (/).                                                                                                                                                                                                                         |
|                       |                                  |    -  Multiple **include** parameters can be specified, for example, **-include=*.xxx -include=*.xxx**.                                                                                                                                                                                                              |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| timeRange             | Optional (additional parameter)  | The time range matching pattern when copying objects. Only objects whose latest modification time is within the configured time range are copied.                                                                                                                                                                    |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | This pattern has a lower priority than the object matching patterns (**exclude**/**include**). That is, the time range matching pattern is executed after the configured object matching patterns.                                                                                                                   |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  The matching time range is represented in *time1*\ **-**\ *time2*, where *time1* must be earlier than or the same as *time2*. The time format is *yyyyMMddHHmmss*.                                                                                                                                             |
|                       |                                  |    -  Automatic formatting is supported. For example, yyyyMMdd is equivalent to yyyyMMdd000000, and yyyyMM is equivalent to yyyyMM01000000.                                                                                                                                                                          |
|                       |                                  |    -  If this parameter is set to **\*-**\ *time2*, all files whose latest modification time is earlier than *time2* are matched. If it is set to *time1*\ **-\***, all files whose latest modification time is later than *time1* are matched.                                                                      |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. important::                                                                                                                                                                                                                                                                                                       |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    NOTICE:                                                                                                                                                                                                                                                                                                           |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  Time in the matching pattern is the UTC time.                                                                                                                                                                                                                                                                  |
|                       |                                  |    -  This matching pattern applies only to objects whose names do not end with a slash (/).                                                                                                                                                                                                                         |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| mf                    | Optional (additional parameter)  | Indicates that the name matching pattern (**include** or **exclude**) and the time matching pattern (**timeRange**) also take effect on objects whose names end with a slash (/).                                                                                                                                    |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| o                     | Optional (additional parameter)  | The folder that stores the result files. After the command is executed, result files (possibly success, failure, and warning files) will be created in the specified folder. The default value is **.obsutil_output**, a subfolder in the user's home directory where obsutil commands are executed.                 |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  | .. note::                                                                                                                                                                                                                                                                                                            |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  A result file should be named as follows: **cp_{succeed \| failed \| warning}_report\_**\ *time*\ **\_**\ *TaskId*\ **.txt**.                                                                                                                                                                                  |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |       By default, the maximum size of a single result file is 30 MB and the maximum number of result files that can be retained is 1,024. You can set the maximum size and number by configuring **recordMaxLogSize** and **recordBackups** in the configuration file.                                               |
|                       |                                  |                                                                                                                                                                                                                                                                                                                      |
|                       |                                  |    -  If there are multiple folders and files and you need to confirm the details of a failed task, refer to the failure result file **cp_failed_report\_**\ *time*\ **\_**\ *TaskId*\ **.txt** in the result folder and the :ref:`log files <obs_11_0056>` in the log path.                                         |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| clear                 | Optional (additional parameter)  | Deletes the failure result files after the copy task is resumed.                                                                                                                                                                                                                                                     |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| config                | Optional (additional parameter)  | The user-defined configuration file for executing the current command. For details about parameters that can be configured, see :ref:`Configuration Parameters <obs_11_0035>`.                                                                                                                                       |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| payer                 | Optional (additional parameter)  | Specifies that requester pays is enabled.                                                                                                                                                                                                                                                                            |
+-----------------------+----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response
--------

Refer to :ref:`Response <obs_11_0013__section6926520122416>` for uploading an object.
